launch_angle >= 5 & launch_angle < 10 ~ "T",
launch_angle >= 10 & launch_angle < 15 ~ "U",
launch_angle >= 15 & launch_angle < 20 ~ "V",
launch_angle >= 20 & launch_angle < 25 ~ "W",
launch_angle >= 25 & launch_angle < 30 ~ "X",
launch_angle >= 30 & launch_angle < 35 ~ "Y",
launch_angle >= 35 & launch_angle < 40 ~ "Z",
launch_angle >= 40 & launch_angle < 45 ~ "AA",
launch_angle >= 45 & launch_angle < 50 ~ "AB",
launch_angle >= 50 & launch_angle < 55 ~ "AC",
launch_angle >= 55 & launch_angle < 60 ~ "AD",
launch_angle >= 60 & launch_angle < 65 ~ "AE",
launch_angle >= 65 & launch_angle < 70 ~ "AF",
launch_angle >= 70 & launch_angle < 75 ~ "AG",
launch_angle >= 75 & launch_angle < 80 ~ "AH",
launch_angle >= 80 & launch_angle < 85 ~ "AI",
launch_angle >= 85 & launch_angle < 90 ~ "AJ",
launch_angle >= 90 & launch_angle < 95 ~ "AK"
))
#Create data set of top 5 exit velocity within each bins
top_5_data <- data_batter %>%
group_by(group) %>%
slice_max(order_by = launch_speed, n = 5) %>%
mutate(top_5 = "Yes") %>%
filter(launch_angle > -40)
#Join two data
data2 <- left_join(data_batter, top_5_data, by = c("player_name", "launch_speed", "launch_angle", "group"))
#Indicate whether or not the exit velocity is in top 10%
data2 <- data2 %>%
mutate(top_5 = ifelse(is.na(top_5), "No", top_5)) %>%
filter(launch_angle > -40, launch_speed > 50)
#Create a quadratic regression for top 5 data
top_5_data$launch_angle2 = top_5_data$launch_angle^2
quadratic_fit <- lm(launch_speed ~ launch_angle + launch_angle2, data = top_5_data)
#Scatter plot data differentiating the top 5 points by color and indicating the maximum predicted value for the launch angle that gives the max exit velocity using the quadratic regression
ggplot(data2) +
geom_point(aes(launch_angle, launch_speed, color = top_5)) +
scale_color_manual(values = c("red", "blue")) +
stat_smooth(method = "lm", formula = y ~ x + I(x^2), data = top_5_data, aes(launch_angle, launch_speed), color = "black", se = FALSE) +
geom_vline(aes(xintercept = top_5_data$launch_angle[which.max(predict(quadratic_fit))]), linetype = "dashed") +
ggtitle(paste("Exit Velocity vs Launch Angle of", batter)) +
scale_x_continuous(name = "Launch Angle (deg)", breaks = seq(-40, 80, by = 10)) +
scale_y_continuous(name = "Exit Velocity (mph)", breaks = seq(50, 120, by = 20)) +
annotate(geom = "text", label = top_5_data$launch_angle[which.max(predict(quadratic_fit))], x = top_5_data$launch_angle[which.max(predict(quadratic_fit))], y = 50, vjust = 1)
}
#Run the plot
Ohtani_plot <- plot_ev_vs_la("Ohtani, Shohei")
Stanton_plot <- plot_ev_vs_la("Stanton, Giancarlo")
ggarrange(Ohtani_plot, Stanton_plot)
la_for_peak_ev <- function(batter, data) {
#Narrow data into Batter Name, Exit Velocity, and Launch Angle with non NA value
data_batter <- data %>%
select(player_name, launch_speed, launch_angle) %>%
na.omit() %>%
filter(player_name == batter)
#Label data with launch angle for every bins of width 5 degrees
data_batter <- data_batter %>%
mutate(group = case_when(launch_angle < -85 ~ "A",
launch_angle >= -85 & launch_angle < -80 ~ "B",
launch_angle >= -80 & launch_angle < -75 ~ "C",
launch_angle >= -75 & launch_angle < -70 ~ "D",
launch_angle >= -70 & launch_angle < -65 ~ "E",
launch_angle >= -65 & launch_angle < -60 ~ "F",
launch_angle >= -60 & launch_angle < -55 ~ "G",
launch_angle >= -55 & launch_angle < -50 ~ "H",
launch_angle >= -50 & launch_angle < -45 ~ "I",
launch_angle >= -45 & launch_angle < -40 ~ "J",
launch_angle >= -40 & launch_angle < -35 ~ "K",
launch_angle >= -35 & launch_angle < -30 ~ "L",
launch_angle >= -30 & launch_angle < -25 ~ "M",
launch_angle >= -25 & launch_angle < -20 ~ "N",
launch_angle >= -20 & launch_angle < -15 ~ "O",
launch_angle >= -15 & launch_angle < -10 ~ "P",
launch_angle >= -10 & launch_angle < -5 ~ "Q",
launch_angle >= -5 & launch_angle < 0 ~ "R",
launch_angle >= 0 & launch_angle < 5 ~ "S",
launch_angle >= 5 & launch_angle < 10 ~ "T",
launch_angle >= 10 & launch_angle < 15 ~ "U",
launch_angle >= 15 & launch_angle < 20 ~ "V",
launch_angle >= 20 & launch_angle < 25 ~ "W",
launch_angle >= 25 & launch_angle < 30 ~ "X",
launch_angle >= 30 & launch_angle < 35 ~ "Y",
launch_angle >= 35 & launch_angle < 40 ~ "Z",
launch_angle >= 40 & launch_angle < 45 ~ "AA",
launch_angle >= 45 & launch_angle < 50 ~ "AB",
launch_angle >= 50 & launch_angle < 55 ~ "AC",
launch_angle >= 55 & launch_angle < 60 ~ "AD",
launch_angle >= 60 & launch_angle < 65 ~ "AE",
launch_angle >= 65 & launch_angle < 70 ~ "AF",
launch_angle >= 70 & launch_angle < 75 ~ "AG",
launch_angle >= 75 & launch_angle < 80 ~ "AH",
launch_angle >= 80 & launch_angle < 85 ~ "AI",
launch_angle >= 85 & launch_angle < 90 ~ "AJ",
launch_angle >= 90 & launch_angle < 95 ~ "AK"
))
#Create data set of top 5 exit velocity within each bins
top_5_data <- data_batter %>%
group_by(group) %>%
slice_max(order_by = launch_speed, n = 5) %>%
mutate(top_5 = "Yes") %>%
filter(launch_angle > -40)
#Create a quadratic regression for top 5 data
top_5_data$launch_angle2 = top_5_data$launch_angle^2
quadratic_fit <- lm(launch_speed ~ launch_angle + launch_angle2, data = top_5_data)
#return launch angle that gives the maximum exit velocity
return(top_5_data$launch_angle[which.max(predict(quadratic_fit))])
}
la_for_peak_ev("Ohtani, Shohei", data)
la_for_peak_ev("Stanton, Giancarlo", data)
la_for_peak_ev("Stanton, Giancarlo", data)
qualified_batters <- filter_data(data) %>%
mutate(la_for_max_ev = la_for_peak_ev(player_name, .))
qualified_batters <- filter_data(data)
qualified_batters <- data %>%
filter(player_name %in% filter_data(data))
View(qualified_batters)
length(unique(qualified_batters$player_name))
qualified_batters <- data %>%
filter(player_name %in% filter_data(data)) %>%
mutate(la_for_max_ev = la_for_peak_ev(player_name, .))
#Function to obtain the launch angle that gives the maximum exit velocity when using quadratic fit for all qualified batters
la_for_peak_ev <- function(batter) {
#Narrow data into Batter Name, Exit Velocity, and Launch Angle with non NA value
data_batter <- data %>%
select(player_name, launch_speed, launch_angle) %>%
na.omit() %>%
filter(player_name == batter)
#Label data with launch angle for every bins of width 5 degrees
data_batter <- data_batter %>%
mutate(group = case_when(launch_angle < -85 ~ "A",
launch_angle >= -85 & launch_angle < -80 ~ "B",
launch_angle >= -80 & launch_angle < -75 ~ "C",
launch_angle >= -75 & launch_angle < -70 ~ "D",
launch_angle >= -70 & launch_angle < -65 ~ "E",
launch_angle >= -65 & launch_angle < -60 ~ "F",
launch_angle >= -60 & launch_angle < -55 ~ "G",
launch_angle >= -55 & launch_angle < -50 ~ "H",
launch_angle >= -50 & launch_angle < -45 ~ "I",
launch_angle >= -45 & launch_angle < -40 ~ "J",
launch_angle >= -40 & launch_angle < -35 ~ "K",
launch_angle >= -35 & launch_angle < -30 ~ "L",
launch_angle >= -30 & launch_angle < -25 ~ "M",
launch_angle >= -25 & launch_angle < -20 ~ "N",
launch_angle >= -20 & launch_angle < -15 ~ "O",
launch_angle >= -15 & launch_angle < -10 ~ "P",
launch_angle >= -10 & launch_angle < -5 ~ "Q",
launch_angle >= -5 & launch_angle < 0 ~ "R",
launch_angle >= 0 & launch_angle < 5 ~ "S",
launch_angle >= 5 & launch_angle < 10 ~ "T",
launch_angle >= 10 & launch_angle < 15 ~ "U",
launch_angle >= 15 & launch_angle < 20 ~ "V",
launch_angle >= 20 & launch_angle < 25 ~ "W",
launch_angle >= 25 & launch_angle < 30 ~ "X",
launch_angle >= 30 & launch_angle < 35 ~ "Y",
launch_angle >= 35 & launch_angle < 40 ~ "Z",
launch_angle >= 40 & launch_angle < 45 ~ "AA",
launch_angle >= 45 & launch_angle < 50 ~ "AB",
launch_angle >= 50 & launch_angle < 55 ~ "AC",
launch_angle >= 55 & launch_angle < 60 ~ "AD",
launch_angle >= 60 & launch_angle < 65 ~ "AE",
launch_angle >= 65 & launch_angle < 70 ~ "AF",
launch_angle >= 70 & launch_angle < 75 ~ "AG",
launch_angle >= 75 & launch_angle < 80 ~ "AH",
launch_angle >= 80 & launch_angle < 85 ~ "AI",
launch_angle >= 85 & launch_angle < 90 ~ "AJ",
launch_angle >= 90 & launch_angle < 95 ~ "AK"
))
#Create data set of top 5 exit velocity within each bins
top_5_data <- data_batter %>%
group_by(group) %>%
slice_max(order_by = launch_speed, n = 5) %>%
mutate(top_5 = "Yes") %>%
filter(launch_angle > -40)
#Create a quadratic regression for top 5 data
top_5_data$launch_angle2 = top_5_data$launch_angle^2
quadratic_fit <- lm(launch_speed ~ launch_angle + launch_angle2, data = top_5_data)
#return launch angle that gives the maximum exit velocity
return(top_5_data$launch_angle[which.max(predict(quadratic_fit))])
}
qualified_batters <- data %>%
filter(player_name %in% filter_data(data)) %>%
mutate(la_for_max_ev = la_for_peak_ev(player_name))
data2 <- data %>%
mutate(la_for_max_ev = la_for_peak_ev(player_name))
data2 <- data %>%
mutate(la_for_max_ev = la_for_peak_ev(data$player_name))
data2 <- data %>%
mutate(la_for_max_ev = la_for_peak_ev(data2$player_name))
qualified_batters
qualified_batters <- data %>%
filter(player_name %in% filter_data(data))
qualified_batters$player_name
qualified_batters$unique(player_name)
unique(qualified_batters$player_name)
las <- list()
las <- list()
i = 1
for(batter in unique(qualified_batters$player_name)) {
las[i] = la_for_peak_ev(batter)
i <- i + 1
}
View(las)
dataa <- data.frame(batters, las)
batters <- unique(qualified_batters$player_name)
dataa <- data.frame(batters, las)
View(dataa)
las
batters
dataa
dataa <- expand.grid(batters, las)
dataa
View(dataa)
las
batters
df <- data.frame(matrix(ncol = 2, nrow = 0))
df <- data.frame(matrix(ncol = 2, nrow = 0))
for(batter in unique(qualified_batters$player_name)) {
df1 = data.frame(hitter = batter, la = la_for_peak_ev(batter))
rbind(df, df1)
}
View(df)
data2 <- data %>%
mutate(la_for_max_ev = la_for_peak_ev(player_name))
data %>%
orint(la_for_peak_ev(player_name)))
data %>%
print(la_for_peak_ev(player_name))
data %>%
print(la_for_peak_ev(data$player_name))
print(la_for_peak_ev("Shohei, Ohtani"))
la_for_peak_ev("Shohei, Ohtani")
#Function to obtain the launch angle that gives the maximum exit velocity when using quadratic fit
la_for_peak_ev <- function(batter) {
#Narrow data into Batter Name, Exit Velocity, and Launch Angle with non NA value
data_batter <- data %>%
select(player_name, launch_speed, launch_angle) %>%
na.omit() %>%
filter(player_name == batter)
#Label data with launch angle for every bins of width 5 degrees
data_batter <- data_batter %>%
mutate(group = case_when(launch_angle < -85 ~ "A",
launch_angle >= -85 & launch_angle < -80 ~ "B",
launch_angle >= -80 & launch_angle < -75 ~ "C",
launch_angle >= -75 & launch_angle < -70 ~ "D",
launch_angle >= -70 & launch_angle < -65 ~ "E",
launch_angle >= -65 & launch_angle < -60 ~ "F",
launch_angle >= -60 & launch_angle < -55 ~ "G",
launch_angle >= -55 & launch_angle < -50 ~ "H",
launch_angle >= -50 & launch_angle < -45 ~ "I",
launch_angle >= -45 & launch_angle < -40 ~ "J",
launch_angle >= -40 & launch_angle < -35 ~ "K",
launch_angle >= -35 & launch_angle < -30 ~ "L",
launch_angle >= -30 & launch_angle < -25 ~ "M",
launch_angle >= -25 & launch_angle < -20 ~ "N",
launch_angle >= -20 & launch_angle < -15 ~ "O",
launch_angle >= -15 & launch_angle < -10 ~ "P",
launch_angle >= -10 & launch_angle < -5 ~ "Q",
launch_angle >= -5 & launch_angle < 0 ~ "R",
launch_angle >= 0 & launch_angle < 5 ~ "S",
launch_angle >= 5 & launch_angle < 10 ~ "T",
launch_angle >= 10 & launch_angle < 15 ~ "U",
launch_angle >= 15 & launch_angle < 20 ~ "V",
launch_angle >= 20 & launch_angle < 25 ~ "W",
launch_angle >= 25 & launch_angle < 30 ~ "X",
launch_angle >= 30 & launch_angle < 35 ~ "Y",
launch_angle >= 35 & launch_angle < 40 ~ "Z",
launch_angle >= 40 & launch_angle < 45 ~ "AA",
launch_angle >= 45 & launch_angle < 50 ~ "AB",
launch_angle >= 50 & launch_angle < 55 ~ "AC",
launch_angle >= 55 & launch_angle < 60 ~ "AD",
launch_angle >= 60 & launch_angle < 65 ~ "AE",
launch_angle >= 65 & launch_angle < 70 ~ "AF",
launch_angle >= 70 & launch_angle < 75 ~ "AG",
launch_angle >= 75 & launch_angle < 80 ~ "AH",
launch_angle >= 80 & launch_angle < 85 ~ "AI",
launch_angle >= 85 & launch_angle < 90 ~ "AJ",
launch_angle >= 90 & launch_angle < 95 ~ "AK"
))
#Create data set of top 5 exit velocity within each bins
top_5_data <- data_batter %>%
group_by(group) %>%
slice_max(order_by = launch_speed, n = 5) %>%
mutate(top_5 = "Yes") %>%
filter(launch_angle > -40)
#Create a quadratic regression for top 5 data
top_5_data$launch_angle2 = top_5_data$launch_angle^2
quadratic_fit <- lm(launch_speed ~ launch_angle + launch_angle2, data = top_5_data)
#return launch angle that gives the maximum exit velocity
return(top_5_data$launch_angle[which.max(predict(quadratic_fit))])
}
la_for_peak_ev("Ohtani, Shohei")
print(la_for_peak_ev("Ohtani, Shohei"))
print(la_for_peak_ev(batter))
for(batter in unique(data$player_name)) {
print(la_for_peak_ev(batter))
}
print(paste0(batter, la_for_peak_ev(batter)))
for(batter in unique(data$player_name)) {
print(paste0(batter, la_for_peak_ev(batter)))
}
df <- data.frame(hitter = " ", launch_angle = 0)
View(df)
df <- data.frame(hitter, launch_angle)
df <- data.frame(hitter = " ", launch_angle = 0)
df1 <- data.frame("Ohtani, Shohei", la_for_peak_ev("Ohtani, Shohei"))
rbind(df, df1)
df1 <- data.frame(hitter = "Ohtani, Shohei", launch_angle = la_for_peak_ev("Ohtani, Shohei"))
rbind(df, df1)
for(batter in unique(data$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter))
rbind(df, new_df)
}
dataaa <- filter_data(data)
dataaa
for(batter in unique(dataaa$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter))
rbind(df, new_df)
}
View(dataa)
View(qualified_batters)
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter))
rbind(df, new_df)
}
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter))
df <- rbind(df, new_df)
}
View(df)
library(pandas)
install.packages("pandas")
library(pandas)
df <- df[-c(1), ]
View(df)
la_for_peak_ev("Ozuna, Marcell")
la_for_peak_ev("Smith, Will")
#Function to obtain the launch angle that gives the maximum exit velocity when using quadratic fit
la_for_peak_ev <- function(batter) {
#Narrow data into Batter Name, Exit Velocity, and Launch Angle with non NA value
data_batter <- data %>%
select(player_name, launch_speed, launch_angle) %>%
na.omit() %>%
filter(player_name == batter)
#Label data with launch angle for every bins of width 5 degrees
data_batter <- data_batter %>%
mutate(group = case_when(launch_angle < -85 ~ "A",
launch_angle >= -85 & launch_angle < -80 ~ "B",
launch_angle >= -80 & launch_angle < -75 ~ "C",
launch_angle >= -75 & launch_angle < -70 ~ "D",
launch_angle >= -70 & launch_angle < -65 ~ "E",
launch_angle >= -65 & launch_angle < -60 ~ "F",
launch_angle >= -60 & launch_angle < -55 ~ "G",
launch_angle >= -55 & launch_angle < -50 ~ "H",
launch_angle >= -50 & launch_angle < -45 ~ "I",
launch_angle >= -45 & launch_angle < -40 ~ "J",
launch_angle >= -40 & launch_angle < -35 ~ "K",
launch_angle >= -35 & launch_angle < -30 ~ "L",
launch_angle >= -30 & launch_angle < -25 ~ "M",
launch_angle >= -25 & launch_angle < -20 ~ "N",
launch_angle >= -20 & launch_angle < -15 ~ "O",
launch_angle >= -15 & launch_angle < -10 ~ "P",
launch_angle >= -10 & launch_angle < -5 ~ "Q",
launch_angle >= -5 & launch_angle < 0 ~ "R",
launch_angle >= 0 & launch_angle < 5 ~ "S",
launch_angle >= 5 & launch_angle < 10 ~ "T",
launch_angle >= 10 & launch_angle < 15 ~ "U",
launch_angle >= 15 & launch_angle < 20 ~ "V",
launch_angle >= 20 & launch_angle < 25 ~ "W",
launch_angle >= 25 & launch_angle < 30 ~ "X",
launch_angle >= 30 & launch_angle < 35 ~ "Y",
launch_angle >= 35 & launch_angle < 40 ~ "Z",
launch_angle >= 40 & launch_angle < 45 ~ "AA",
launch_angle >= 45 & launch_angle < 50 ~ "AB",
launch_angle >= 50 & launch_angle < 55 ~ "AC",
launch_angle >= 55 & launch_angle < 60 ~ "AD",
launch_angle >= 60 & launch_angle < 65 ~ "AE",
launch_angle >= 65 & launch_angle < 70 ~ "AF",
launch_angle >= 70 & launch_angle < 75 ~ "AG",
launch_angle >= 75 & launch_angle < 80 ~ "AH",
launch_angle >= 80 & launch_angle < 85 ~ "AI",
launch_angle >= 85 & launch_angle < 90 ~ "AJ",
launch_angle >= 90 & launch_angle < 95 ~ "AK"
))
#Create data set of top 5 exit velocity within each bins
top_5_data <- data_batter %>%
group_by(group) %>%
slice_max(order_by = launch_speed, n = 5) %>%
mutate(top_5 = "Yes") %>%
filter(launch_angle > -40)
#Create a quadratic regression for top 5 data
top_5_data$launch_angle2 = top_5_data$launch_angle^2
quadratic_fit <- lm(launch_speed ~ launch_angle + launch_angle2, data = top_5_data)
#return launch angle that gives the maximum exit velocity
return(list(top_5_data$launch_angle[which.max(predict(quadratic_fit))], max(predict(quadratic_fit))))
}
la_for_peak_ev("Ohtani, Shohei")
df <- data.frame(hitter = " ", launch_angle = 0, exit_velo = 0)
qualified_batters <- data %>%
filter(player_name %in% filter_data(data))
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter)[1], la_for_peak_ev(batter)[2])
df <- rbind(df, new_df)
}
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter)[1], exit_velo = la_for_peak_ev(batter)[2])
df <- rbind(df, new_df)
}
la_for_peak_ev("Ohtani, Shohei")[1]
la_for_peak_ev("Ohtani, Shohei")[2]
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter)[1], exit_velo = la_for_peak_ev(batter)[2])
df <- rbind(df, new_df)
}
#Function to obtain the launch angle that gives the maximum exit velocity when using quadratic fit
la_for_peak_ev <- function(batter) {
#Narrow data into Batter Name, Exit Velocity, and Launch Angle with non NA value
data_batter <- data %>%
select(player_name, launch_speed, launch_angle) %>%
na.omit() %>%
filter(player_name == batter)
#Label data with launch angle for every bins of width 5 degrees
data_batter <- data_batter %>%
mutate(group = case_when(launch_angle < -85 ~ "A",
launch_angle >= -85 & launch_angle < -80 ~ "B",
launch_angle >= -80 & launch_angle < -75 ~ "C",
launch_angle >= -75 & launch_angle < -70 ~ "D",
launch_angle >= -70 & launch_angle < -65 ~ "E",
launch_angle >= -65 & launch_angle < -60 ~ "F",
launch_angle >= -60 & launch_angle < -55 ~ "G",
launch_angle >= -55 & launch_angle < -50 ~ "H",
launch_angle >= -50 & launch_angle < -45 ~ "I",
launch_angle >= -45 & launch_angle < -40 ~ "J",
launch_angle >= -40 & launch_angle < -35 ~ "K",
launch_angle >= -35 & launch_angle < -30 ~ "L",
launch_angle >= -30 & launch_angle < -25 ~ "M",
launch_angle >= -25 & launch_angle < -20 ~ "N",
launch_angle >= -20 & launch_angle < -15 ~ "O",
launch_angle >= -15 & launch_angle < -10 ~ "P",
launch_angle >= -10 & launch_angle < -5 ~ "Q",
launch_angle >= -5 & launch_angle < 0 ~ "R",
launch_angle >= 0 & launch_angle < 5 ~ "S",
launch_angle >= 5 & launch_angle < 10 ~ "T",
launch_angle >= 10 & launch_angle < 15 ~ "U",
launch_angle >= 15 & launch_angle < 20 ~ "V",
launch_angle >= 20 & launch_angle < 25 ~ "W",
launch_angle >= 25 & launch_angle < 30 ~ "X",
launch_angle >= 30 & launch_angle < 35 ~ "Y",
launch_angle >= 35 & launch_angle < 40 ~ "Z",
launch_angle >= 40 & launch_angle < 45 ~ "AA",
launch_angle >= 45 & launch_angle < 50 ~ "AB",
launch_angle >= 50 & launch_angle < 55 ~ "AC",
launch_angle >= 55 & launch_angle < 60 ~ "AD",
launch_angle >= 60 & launch_angle < 65 ~ "AE",
launch_angle >= 65 & launch_angle < 70 ~ "AF",
launch_angle >= 70 & launch_angle < 75 ~ "AG",
launch_angle >= 75 & launch_angle < 80 ~ "AH",
launch_angle >= 80 & launch_angle < 85 ~ "AI",
launch_angle >= 85 & launch_angle < 90 ~ "AJ",
launch_angle >= 90 & launch_angle < 95 ~ "AK"
))
#Create data set of top 5 exit velocity within each bins
top_5_data <- data_batter %>%
group_by(group) %>%
slice_max(order_by = launch_speed, n = 5) %>%
mutate(top_5 = "Yes") %>%
filter(launch_angle > -40)
#Create a quadratic regression for top 5 data
top_5_data$launch_angle2 = top_5_data$launch_angle^2
quadratic_fit <- lm(launch_speed ~ launch_angle + launch_angle2, data = top_5_data)
#return launch angle that gives the maximum exit velocity
return(list(top_5_data$launch_angle[which.max(predict(quadratic_fit))], max(predict(quadratic_fit))))
}
qualified_batters <- data %>%
filter(player_name %in% filter_data(data))
df <- data.frame(hitter = " ", launch_angle = 0, exit_velo = 0)
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter)[1], exit_velo = la_for_peak_ev(batter)[2])
df <- rbind(df, new_df)
}
df <- data.frame(hitter = " ", launch_angle = 0)
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = la_for_peak_ev(batter)[1])
df <- rbind(df, new_df)
}
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = (la_for_peak_ev(batter)[1]))
df <- rbind(df, new_df)
}
la_for_peak_ev("Ohtani, Shohei")[2]
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = as.numeric(la_for_peak_ev(batter)[1]))
df <- rbind(df, new_df)
}
df <- data.frame(hitter = " ", launch_angle = 0, exit_velo = 0)
for(batter in unique(qualified_batters$player_name)) {
new_df <- data.frame(hitter = batter, launch_angle = as.numeric(la_for_peak_ev(batter)[1]), exit_velo = as.numeric(la_for_peak_ev(batter)[2]))
df <- rbind(df, new_df)
}
df <- df[-c(1), ]
min(df$launch_angle)
max(df$launch_angle)
min_la_player <- df %>%
filter(launch_angle = min(df$launch_angle))
min_la_player <- df %>%
filter(launch_angle == min(df$launch_angle))
max_la_player <- df %>%
filter(launch_angle == max(df$launch_angle))
min_la_player
max_la_player
Rogers_plot <- plot_ev_vs_la("Rogers, Jake")
Fletcher_plot <- plot_ev_vs_la("Fletcher, David")
ggarrange(Fletcher_plot, Rogers_plot)
